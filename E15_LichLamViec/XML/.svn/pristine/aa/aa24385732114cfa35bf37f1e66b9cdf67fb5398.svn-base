<?xml version="1.0" standalone="yes" ?>
<NewDataSet>
	<xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
		<xs:element name="NewDataSet" msdata:IsDataSet="true">
			<xs:complexType>
				<xs:choice maxOccurs="unbounded">
					<xs:element name="Table">
						<xs:complexType>
							<xs:sequence>
								<xs:element name="ma" type="xs:string" minOccurs="0" />
								<xs:element name="ten" type="xs:string" minOccurs="0" />
								<xs:element name="sql" type="xs:string" minOccurs="0" />
								<xs:element name="cont" type="xs:string" minOccurs="0" />
								<xs:element name="stt" type="xs:string" minOccurs="0" />
							</xs:sequence>
						</xs:complexType>
					</xs:element>
				</xs:choice>
			</xs:complexType>
		</xs:element>
	</xs:schema>
	<Table>
		<ma>phongkham</ma>
		<ten>Phòng khám</ten>
		<sql>select case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end stt,count(*) c01,sum(case when substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1) then 1 else 0 end) c02,sum(case when (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c03,sum(case when (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c04,sum(case when (substr(b.tuoivao,1,3)&gt;=5 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;15 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c05,sum(case when substr(b.tuoivao,1,3)&gt;=15 and substr(b.tuoivao,4,1)=0 then 1 else 0 end) c06,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1)) then 1 else 0 end) c07,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c08,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c09,sum(case when a.ttlucrv=7 then 1 else 0 end) c10,sum(case when a.ttlucrv=7 then 1 else 0 end) c11,sum(case when a.ttlucrv=1 then 1 else 0 end) c12,sum(case when a.ttlucrv=2 then 1 else 0 end) c13,sum(case when a.ttlucrv=3 then 1 else 0 end) c14,sum(case when a.ttlucrv=4 then 1 else 0 end) c15,sum(case when a.ttlucrv=5 then 1 else 0 end) c16,sum(case when a.ttlucrv=6 then 1 else 0 end) c17,0 c18 from hismmyy.benhanpk a inner join hismmyy.lienhe b on a.maql=b.maql inner join his.btdbn c on a.mabn=c.mabn where a.maql&gt;0</sql>
		<cont>(a.maicd in ('A90') or a.maicd in ('A91','A91.1','A91.-1','A91.+1') or a.maicd in ('A91.2','A91.-2','A91.+2') or a.maicd in ('A91.3','A91.-3','A91.+3') or a.maicd in ('A91.4','A91.-4','A91.+4'))</cont>
		<stt>case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt>
		<stt1>case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt1>
	</Table>
	<Table>
		<ma>ngoaitru</ma>
		<ten>Ngoại trú</ten>
		<sql>select case when a.maicdrv in ('A90') then '00' else case when a.maicdrv in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicdrv in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicdrv in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicdrv in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end stt,count(*) c01,sum(case when substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1) then 1 else 0 end) c02,sum(case when (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c03,sum(case when (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c04,sum(case when (substr(b.tuoivao,1,3)&gt;=5 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;15 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c05,sum(case when substr(b.tuoivao,1,3)&gt;=15 and substr(b.tuoivao,4,1)=0 then 1 else 0 end) c06,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1)) then 1 else 0 end) c07,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c08,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c09,sum(case when a.ttlucrv=7 then 1 else 0 end) c10,sum(case when a.ttlucrv=7 and a.ngayrv-a.ngay&lt;1 then 1 else 0 end) c11,sum(case when a.ttlucrv=1 then 1 else 0 end) c12,sum(case when a.ttlucrv=2 then 1 else 0 end) c13,sum(case when a.ttlucrv=3 then 1 else 0 end) c14,sum(case when a.ttlucrv=4 then 1 else 0 end) c15,sum(case when a.ttlucrv=5 then 1 else 0 end) c16,sum(case when a.ttlucrv=6 then 1 else 0 end) c17,0 c18 from his.benhanngtr a inner join his.lienhe b on a.maql=b.maql inner join his.btdbn c on a.mabn=c.mabn where a.maql&gt;0</sql>
		<cont>(a.maicdrv in ('A90') or a.maicdrv in ('A91','A91.1','A91.-1','A91.+1') or a.maicdrv in ('A91.2','A91.-2','A91.+2') or a.maicdrv in ('A91.3','A91.-3','A91.+3') or a.maicdrv in ('A91.4','A91.-4','A91.+4'))</cont>
		<stt>case when a.maicdrv in ('A90') then '00' else case when a.maicdrv in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicdrv in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicdrv in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicdrv in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt>
		<stt1>case when a.maicdrv in ('A90') then '00' else case when a.maicdrv in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicdrv in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicdrv in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicdrv in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt1>
	</Table>
	<Table>
		<ma>phongluu</ma>
		<ten>Phòng lưu</ten>
		<sql>select case when a.maicdrv in ('A90') then '00' else case when a.maicdrv in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicdrv in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicdrv in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicdrv in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end stt,count(*) c01,sum(case when substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1) then 1 else 0 end) c02,sum(case when (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c03,sum(case when (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c04,sum(case when (substr(b.tuoivao,1,3)&gt;=5 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;15 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c05,sum(case when substr(b.tuoivao,1,3)&gt;=15 and substr(b.tuoivao,4,1)=0 then 1 else 0 end) c06,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1)) then 1 else 0 end) c07,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c08,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c09,sum(case when a.ttlucrv=7 then 1 else 0 end) c10,sum(case when a.ttlucrv=7 and a.ngayrv-a.ngay&lt;1 then 1 else 0 end) c11,sum(case when a.ttlucrv=1 then 1 else 0 end) c12,sum(case when a.ttlucrv=2 then 1 else 0 end) c13,sum(case when a.ttlucrv=3 then 1 else 0 end) c14,sum(case when a.ttlucrv=4 then 1 else 0 end) c15,sum(case when a.ttlucrv=5 then 1 else 0 end) c16,sum(case when a.ttlucrv=6 then 1 else 0 end) c17,0 c18 from hismmyy.benhancc a inner join hismmyy.lienhe b on a.maql=b.maql inner join his.btdbn c on a.mabn=c.mabn where a.maql&gt;0</sql>
		<cont>(a.maicdrv in ('A90') or a.maicdrv in ('A91','A91.1','A91.-1','A91.+1') or a.maicdrv in ('A91.2','A91.-2','A91.+2') or a.maicdrv in ('A91.3','A91.-3','A91.+3') or a.maicdrv in ('A91.4','A91.-4','A91.+4'))</cont>
		<stt>case when a.maicdrv in ('A90') then '00' else case when a.maicdrv in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicdrv in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicdrv in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicdrv in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt>
		<stt1>case when a.maicdrv in ('A90') then '00' else case when a.maicdrv in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicdrv in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicdrv in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicdrv in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt1>
	</Table>
	<Table>
		<ma>benhandt</ma>
		<ten>Nhập viện</ten>
		<sql>select case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end stt,count(*) c01,sum(case when substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1) then 1 else 0 end) c02,sum(case when (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c03,sum(case when (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c04,sum(case when (substr(b.tuoivao,1,3)&gt;=5 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;15 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c05,sum(case when substr(b.tuoivao,1,3)&gt;=15 and substr(b.tuoivao,4,1)=0 then 1 else 0 end) c06,0 c07,0 c08,0 c09,0 c10,0 c11,0 c12,0 c13,0 c14,0 c15,0 c16,0 c17,0 c18 from his.benhandt a inner join his.lienhe b on a.maql=b.maql inner join his.btdbn c on a.mabn=c.mabn where a.maql&gt;0</sql>
		<cont>(a.maicd in ('A90') or a.maicd in ('A91','A91.1','A91.-1','A91.+1') or a.maicd in ('A91.2','A91.-2','A91.+2') or a.maicd in ('A91.3','A91.-3','A91.+3') or a.maicd in ('A91.4','A91.-4','A91.+4'))</cont>
		<stt>case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt>
	</Table>
	<Table>
		<ma>nhapkhoa</ma>
		<ten>Nhập khoa</ten>
		<sql>select case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end stt,count(*) c01,sum(case when substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1) then 1 else 0 end) c02,sum(case when (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c03,sum(case when (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c04,sum(case when (substr(b.tuoivao,1,3)&gt;=5 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;15 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c05,sum(case when substr(b.tuoivao,1,3)&gt;=15 and substr(b.tuoivao,4,1)=0 then 1 else 0 end) c06,0 c07,0 c08,0 c09,0 c10,0 c11,0 c12,0 c13,0 c14,0 c15,0 c16,0 c17,0 c18 from his.nhapkhoa a inner join his.lienhe b on a.maql=b.maql inner join his.btdbn c on a.mabn=c.mabn inner join his.benhandt d on a.maql=d.maql where a.maql&gt;0</sql>
		<cont>(a.maicd in ('A90') or a.maicd in ('A91','A91.1','A91.-1','A91.+1') or a.maicd in ('A91.2','A91.-2','A91.+2') or a.maicd in ('A91.3','A91.-3','A91.+3') or a.maicd in ('A91.4','A91.-4','A91.+4'))</cont>
		<stt>case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt>
	</Table>
	<Table>
		<ma>xuatkhoa</ma>
		<ten>Xuất khoa</ten>
		<sql>select case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end stt,count(*) c01,sum(case when substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1) then 1 else 0 end) c02,sum(case when (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c03,sum(case when (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c04,sum(case when (substr(b.tuoivao,1,3)&gt;=5 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;15 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c05,sum(case when substr(b.tuoivao,1,3)&gt;=15 and substr(b.tuoivao,4,1)=0 then 1 else 0 end) c06,sum(case when (a.ttlucrk=7) and (substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1)) then 1 else 0 end) c07,sum(case when (a.ttlucrk=7) and (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c08,sum(case when (a.ttlucrk=7) and (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c09,sum(case when a.ttlucrk=7 then 1 else 0 end) c10,sum(case when a.ttlucrk=7 and a.ngay-d.ngay&lt;1 then 1 else 0 end) c11,sum(case when a.ttlucrk=1 then 1 else 0 end) c12,sum(case when a.ttlucrk=2 then 1 else 0 end) c13,sum(case when a.ttlucrk=3 then 1 else 0 end) c14,sum(case when a.ttlucrk=4 then 1 else 0 end) c15,sum(case when a.ttlucrk=5 then 1 else 0 end) c16,sum(case when a.ttlucrk=6 then 1 else 0 end) c17,0 c18 from his.xuatkhoa a inner join his.nhapkhoa d on a.id=d.id inner join his.lienhe b on d.maql=b.maql inner join his.btdbn c on d.mabn=c.mabn inner join his.benhandt e on d.maql=e.maql where d.maql&gt;0</sql>
		<cont>(a.maicd in ('A90') or a.maicd in ('A91','A91.1','A91.-1','A91.+1') or a.maicd in ('A91.2','A91.-2','A91.+2') or a.maicd in ('A91.3','A91.-3','A91.+3') or a.maicd in ('A91.4','A91.-4','A91.+4'))</cont>
		<stt>case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt>
	</Table>
	<Table>
		<ma>xuatvien</ma>
		<ten>Xuất viện</ten>
		<sql>select case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end stt,count(*) c01,sum(case when substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1) then 1 else 0 end) c02,sum(case when (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c03,sum(case when (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c04,sum(case when (substr(b.tuoivao,1,3)&gt;=5 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;15 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c05,sum(case when substr(b.tuoivao,1,3)&gt;=15 and substr(b.tuoivao,4,1)=0 then 1 else 0 end) c06,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,4,1) in (2,3) or (substr(b.tuoivao,1,3)&lt;2 and substr(b.tuoivao,4,1)=1)) then 1 else 0 end) c07,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,1,3)&gt;=2 and substr(b.tuoivao,4,1)=1) or (substr(b.tuoivao,1,3)&lt;1 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c08,sum(case when (a.ttlucrv=7) and (substr(b.tuoivao,1,3)&gt;=1 and substr(b.tuoivao,4,1)=0) and (substr(b.tuoivao,1,3)&lt;5 and substr(b.tuoivao,4,1)=0) then 1 else 0 end) c09,sum(case when a.ttlucrv=7 then 1 else 0 end) c10,sum(case when a.ttlucrv=7 and a.ngay-d.ngay&lt;1 then 1 else 0 end) c11,sum(case when a.ttlucrv=1 then 1 else 0 end) c12,sum(case when a.ttlucrv=2 then 1 else 0 end) c13,sum(case when a.ttlucrv=3 then 1 else 0 end) c14,sum(case when a.ttlucrv=4 then 1 else 0 end) c15,sum(case when a.ttlucrv=5 then 1 else 0 end) c16,sum(case when a.ttlucrv=6 then 1 else 0 end) c17,0 c18 from his.xuatvien a inner join his.lienhe b on a.maql=b.maql inner join his.btdbn c on a.mabn=c.mabn inner join his.benhandt d on a.maql=d.maql where a.maql&gt;0</sql>
		<cont>(a.maicd in ('A90') or a.maicd in ('A91','A91.1','A91.-1','A91.+1') or a.maicd in ('A91.2','A91.-2','A91.+2') or a.maicd in ('A91.3','A91.-3','A91.+3') or a.maicd in ('A91.4','A91.-4','A91.+4'))</cont>
		<stt>case when a.maicd in ('A90') then '00' else case when a.maicd in ('A91','A91.1','A91.-1','A91.+1') then '01' else case when a.maicd in ('A91.2','A91.-2','A91.+2') then '02' else case when a.maicd in ('A91.3','A91.-3','A91.+3') then '03' else case when a.maicd in ('A91.4','A91.-4','A91.+4') then '04' else '15' end end end end end</stt>
	</Table>
</NewDataSet>